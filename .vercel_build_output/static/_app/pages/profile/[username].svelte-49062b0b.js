import{N as t,S as s,i as e,s as n,e as a,t as o,k as r,c as i,a as c,g as u,d,n as h,b as l,f,G as v,H as b,h as g,L as p,O as w,A as m}from"../../chunks/vendor-19443505.js";const y=t=>{throw new Error(`Cannot ${t} session store before subscribing`)},x={subscribe(s){const e=(()=>{const s=t("__svelte__");return{page:{subscribe:s.page.subscribe},navigating:{subscribe:s.navigating.subscribe},get preloading(){return console.error("stores.preloading is deprecated; use stores.navigating instead"),{subscribe:s.navigating.subscribe}},session:s.session}})().session;return x.set=e.set,x.update=e.update,e.subscribe(s)},set:()=>y("set"),update:()=>y("update")};function _(t){var s;let e,n,w,m,y,x,_,j,k=(null==(s=t[0])?void 0:s.username)+"";return{c(){e=a("h1"),n=o("Hej, "),w=o(k),m=r(),y=a("button"),x=o("Logout"),this.h()},l(t){e=i(t,"H1",{});var s=c(e);n=u(s,"Hej, "),w=u(s,k),s.forEach(d),m=h(t),y=i(t,"BUTTON",{class:!0});var a=c(y);x=u(a,"Logout"),a.forEach(d),this.h()},h(){l(y,"class","bg-red-300 p-4 rounded")},m(s,a){f(s,e,a),v(e,n),v(e,w),f(s,m,a),f(s,y,a),v(y,x),_||(j=b(y,"click",t[1]),_=!0)},p(t,[s]){var e;1&s&&k!==(k=(null==(e=t[0])?void 0:e.username)+"")&&g(w,k)},i:p,o:p,d(t){t&&d(e),t&&d(m),t&&d(y),_=!1,j()}}}var j=function(t,s,e,n){return new(e||(e=Promise))((function(a,o){function r(t){try{c(n.next(t))}catch(s){o(s)}}function i(t){try{c(n.throw(t))}catch(s){o(s)}}function c(t){var s;t.done?a(t.value):(s=t.value,s instanceof e?s:new e((function(t){t(s)}))).then(r,i)}c((n=n.apply(t,s||[])).next())}))};const k=({session:t})=>j(void 0,void 0,void 0,(function*(){return t.authenticated?{}:{status:302,redirect:"/login"}}));function H(t,s,e){let n;w(t,x,(t=>e(3,n=t)));var a=this&&this.__awaiter||function(t,s,e,n){return new(e||(e=Promise))((function(a,o){function r(t){try{c(n.next(t))}catch(s){o(s)}}function i(t){try{c(n.throw(t))}catch(s){o(s)}}function c(t){var s;t.done?a(t.value):(s=t.value,s instanceof e?s:new e((function(t){t(s)}))).then(r,i)}c((n=n.apply(t,s||[])).next())}))};let o,r;return m((()=>{e(0,r=n.user)})),[r,function(){return a(this,void 0,void 0,(function*(){try{const t=yield fetch("/api/auth/logout",{method:"POST"});if(!t.ok){const s=yield t.json();throw o=s.message,o}location.reload()}catch(t){}}))}]}class E extends s{constructor(t){super(),e(this,t,H,_,n,{})}}export{E as default,k as load};
